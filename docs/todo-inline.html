<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>todo-inline</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
  body {
    max-width: 50em;
  }
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">todo-inline</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#bug-20-items"><strong>BUG</strong> – 20 items</a></li>
<li><a href="#review-15-items"><strong>REVIEW</strong> – 15 items</a></li>
<li><a href="#todo-30-items"><strong>TODO</strong> – 30 items</a></li>
<li><a href="#note-9-items"><strong>NOTE</strong> – 9 items</a></li>
<li><a href="#optimize-5-items"><strong>OPTIMIZE</strong> – 5 items</a></li>
<li><a href="#hack-1-item"><strong>HACK</strong> – 1 item</a></li>
<li><a href="#ugly-6-items"><strong>UGLY</strong> – 6 items</a></li>
</ul>
</nav>
<h1 id="bug-20-items"><strong>BUG</strong> – 20 items</h1>
<h2 id="modulescollide.cpp-1-item"><a href="../modules/Collide.cpp"><code>../modules/Collide.cpp</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
BUG(” &gt;&gt; elements in CollObjs vec: %ld“, CollObjs.size()) (line 115)</p><details>
<div class="sourceCode" id="cb1" data-startFrom="115"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 114;"><span id="cb1-115"><a href="#cb1-115"></a> PRINTF_DEBUG<span class="op">(</span><span class="st">&quot;    &gt;&gt; elements in CollObjs vec: </span><span class="sc">%ld\n</span><span class="st">&quot;</span><span class="op">,</span> CollObjs<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb1-116"><a href="#cb1-116"></a> <span class="cf">for</span> <span class="op">(</span>CollisionObject obj <span class="op">:</span> CollObjs<span class="op">)</span></span>
<span id="cb1-117"><a href="#cb1-117"></a> <span class="op">{</span></span>
<span id="cb1-118"><a href="#cb1-118"></a>     <span class="cf">if</span> <span class="op">(</span>obj<span class="op">.</span><span class="dt">coll_type</span> <span class="op">==</span> Box_Ax<span class="op">)</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesnervoussystem.cpp-4-items"><a href="../modules/NervousSystem.cpp"><code>../modules/NervousSystem.cpp</code></a> – 4 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; circuit init“) (line 30)</p><details>
<div class="sourceCode" id="cb2" data-startFrom="30"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 29;"><span id="cb2-30"><a href="#cb2-30"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; circuit init</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb2-31"><a href="#cb2-31"></a> <span class="co">// compute and set the circuit size</span></span>
<span id="cb2-32"><a href="#cb2-32"></a> SetCircuitSize<span class="op">(</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>     compute_size<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;neurons&quot;</span><span class="op">]),</span></span>
<span id="cb2-34"><a href="#cb2-34"></a>     compute_maxconn_bidir_sum<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections&quot;</span><span class="op">],</span> CONNTYPE_CHEM<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; loading neurons“) (line 40)</p><details>
<div class="sourceCode" id="cb3" data-startFrom="40"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 39;"><span id="cb3-40"><a href="#cb3-40"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; loading neurons</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-41"><a href="#cb3-41"></a> namesMapInv <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>string<span class="op">&gt;(</span>size <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;NULL&quot;</span><span class="op">);</span></span>
<span id="cb3-42"><a href="#cb3-42"></a> loadJSON_neurons<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;neurons&quot;</span><span class="op">]);</span></span>
<span id="cb3-43"><a href="#cb3-43"></a> <span class="co">// load the connections</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; adding synapses“) (line 45)</p><details>
<div class="sourceCode" id="cb4" data-startFrom="45"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 44;"><span id="cb4-45"><a href="#cb4-45"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; adding synapses</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb4-46"><a href="#cb4-46"></a> <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> syn <span class="op">:</span> ns_data<span class="op">[</span><span class="st">&quot;connections&quot;</span><span class="op">])</span></span>
<span id="cb4-47"><a href="#cb4-47"></a> <span class="op">{</span></span>
<span id="cb4-48"><a href="#cb4-48"></a>     AddSynapse_JSON<span class="op">(</span>syn<span class="op">);</span></span>
<span id="cb4-49"><a href="#cb4-49"></a> <span class="op">}</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; circuit init“) (line 55)</p><details>
<div class="sourceCode" id="cb5" data-startFrom="55"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 54;"><span id="cb5-55"><a href="#cb5-55"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; circuit init</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-56"><a href="#cb5-56"></a></span>
<span id="cb5-57"><a href="#cb5-57"></a> <span class="co">// compute and set the circuit size</span></span>
<span id="cb5-58"><a href="#cb5-58"></a> <span class="dt">int</span> unit_size <span class="op">=</span> compute_size<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;neurons&quot;</span><span class="op">]);</span></span>
<span id="cb5-59"><a href="#cb5-59"></a> <span class="co">// REVIEW: connection count calculation is bugged :/</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesworm.cpp-10-items"><a href="../modules/Worm.cpp"><code>../modules/Worm.cpp</code></a> – 10 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; muscles“) (line 178)</p><details>
<div class="sourceCode" id="cb6" data-startFrom="178"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 177;"><span id="cb6-178"><a href="#cb6-178"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; muscles</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb6-179"><a href="#cb6-179"></a> m<span class="op">.</span>SetMuscleParams<span class="op">(</span>N_muscles<span class="op">,</span> T_muscle<span class="op">);</span></span>
<span id="cb6-180"><a href="#cb6-180"></a> <span class="co">// PRINT_DEBUG(&quot;  &gt; validating NS params\n&quot;)</span></span>
<span id="cb6-181"><a href="#cb6-181"></a> <span class="co">// params[&quot;Head&quot;]</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; Head NS“) (line 186)</p><details>
<div class="sourceCode" id="cb7" data-startFrom="186"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 185;"><span id="cb7-186"><a href="#cb7-186"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; Head NS</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-187"><a href="#cb7-187"></a> h<span class="op">.</span>init_NS<span class="op">(</span>params<span class="op">[</span><span class="st">&quot;Head&quot;</span><span class="op">]);</span></span>
<span id="cb7-188"><a href="#cb7-188"></a> <span class="co">// VC Circuit</span></span>
<span id="cb7-189"><a href="#cb7-189"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; VentralCord NS</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-190"><a href="#cb7-190"></a> n<span class="op">.</span>init_NS_repeatedUnits<span class="op">(</span>params<span class="op">[</span><span class="st">&quot;VentralCord&quot;</span><span class="op">],</span> N_units<span class="op">);</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; VentralCord NS“) (line 189)</p><details>
<div class="sourceCode" id="cb8" data-startFrom="189"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 188;"><span id="cb8-189"><a href="#cb8-189"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; VentralCord NS</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb8-190"><a href="#cb8-190"></a> n<span class="op">.</span>init_NS_repeatedUnits<span class="op">(</span>params<span class="op">[</span><span class="st">&quot;VentralCord&quot;</span><span class="op">],</span> N_units<span class="op">);</span></span>
<span id="cb8-191"><a href="#cb8-191"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; updating neuron indecies</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; updating neuron indecies“) (line 193)</p><details>
<div class="sourceCode" id="cb9" data-startFrom="193"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 192;"><span id="cb9-193"><a href="#cb9-193"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; updating neuron indecies</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb9-194"><a href="#cb9-194"></a> SMDD <span class="op">=</span> h<span class="op">.</span>namesMap<span class="op">[</span><span class="st">&quot;SMDD&quot;</span><span class="op">];</span></span>
<span id="cb9-195"><a href="#cb9-195"></a> RMDD <span class="op">=</span> h<span class="op">.</span>namesMap<span class="op">[</span><span class="st">&quot;RMDD&quot;</span><span class="op">];</span></span>
<span id="cb9-196"><a href="#cb9-196"></a> SMDV <span class="op">=</span> h<span class="op">.</span>namesMap<span class="op">[</span><span class="st">&quot;SMDV&quot;</span><span class="op">];</span></span>
<span id="cb9-197"><a href="#cb9-197"></a> RMDV <span class="op">=</span> h<span class="op">.</span>namesMap<span class="op">[</span><span class="st">&quot;RMDV&quot;</span><span class="op">];</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; Stretch Receptors“) (line 207)</p><details>
<div class="sourceCode" id="cb10" data-startFrom="207"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 206;"><span id="cb10-207"><a href="#cb10-207"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; Stretch Receptors</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb10-208"><a href="#cb10-208"></a> sr<span class="op">.</span>SetStretchReceptorParams<span class="op">(</span></span>
<span id="cb10-209"><a href="#cb10-209"></a>     N_segments<span class="op">,</span> </span>
<span id="cb10-210"><a href="#cb10-210"></a>     N_stretchrec<span class="op">,</span> </span>
<span id="cb10-211"><a href="#cb10-211"></a>     params<span class="op">[</span><span class="st">&quot;StretchReceptors&quot;</span><span class="op">][</span><span class="st">&quot;VC_gain&quot;</span><span class="op">].</span>get<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(),</span> </span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; NMJ params“) (line 253)</p><details>
<div class="sourceCode" id="cb11" data-startFrom="253"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 252;"><span id="cb11-253"><a href="#cb11-253"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; NMJ params</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb11-254"><a href="#cb11-254"></a> NMJ_DB <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;DB&quot;</span><span class="op">];</span></span>
<span id="cb11-255"><a href="#cb11-255"></a> NMJ_VBa <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;VBA&quot;</span><span class="op">];</span></span>
<span id="cb11-256"><a href="#cb11-256"></a> NMJ_VBp <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;VBP&quot;</span><span class="op">];</span></span>
<span id="cb11-257"><a href="#cb11-257"></a> NMJ_DD <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;DD&quot;</span><span class="op">];</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; NMJ gain (?)“) (line 268)</p><details>
<div class="sourceCode" id="cb12" data-startFrom="268"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 267;"><span id="cb12-268"><a href="#cb12-268"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; NMJ gain (?)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb12-269"><a href="#cb12-269"></a> NMJ_Gain_Map <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb12-270"><a href="#cb12-270"></a> NMJ_Gain<span class="op">.</span>SetBounds<span class="op">(</span><span class="dv">1</span><span class="op">,</span> N_muscles<span class="op">);</span></span>
<span id="cb12-271"><a href="#cb12-271"></a> <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&lt;=</span>N_muscles<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb12-272"><a href="#cb12-272"></a> <span class="op">{</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; Worm object ctor done!“) (line 275)</p><details>
<div class="sourceCode" id="cb13" data-startFrom="275"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 274;"><span id="cb13-275"><a href="#cb13-275"></a>     PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; Worm object ctor done!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb13-276"><a href="#cb13-276"></a> <span class="op">}</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; circuit state“) (line 283)</p><details>
<div class="sourceCode" id="cb14" data-startFrom="283"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 282;"><span id="cb14-283"><a href="#cb14-283"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; circuit state</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb14-284"><a href="#cb14-284"></a> t <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb14-285"><a href="#cb14-285"></a> n<span class="op">.</span>RandomizeCircuitState<span class="op">(-</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> rs<span class="op">);</span></span>
<span id="cb14-286"><a href="#cb14-286"></a> h<span class="op">.</span>RandomizeCircuitState<span class="op">(-</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> rs<span class="op">);</span></span>
<span id="cb14-287"><a href="#cb14-287"></a> PRINTF_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; body state</span><span class="sc">\n</span><span class="st">      &gt;&gt; angle: </span><span class="sc">%f</span><span class="st">, collision obj count: </span><span class="sc">%ld\n</span><span class="st">&quot;</span><span class="op">,</span> angle<span class="op">,</span> collObjs<span class="op">.</span>size<span class="op">())</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG(” &gt; muscle state“) (line 289)</p><details>
<div class="sourceCode" id="cb15" data-startFrom="289"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 288;"><span id="cb15-289"><a href="#cb15-289"></a>     PRINT_DEBUG<span class="op">(</span><span class="st">&quot;    &gt; muscle state</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb15-290"><a href="#cb15-290"></a>     m<span class="op">.</span>InitializeMuscleState<span class="op">();</span></span>
<span id="cb15-291"><a href="#cb15-291"></a> <span class="op">}</span></span>
<span id="cb15-292"><a href="#cb15-292"></a> <span class="dt">void</span> Worm<span class="op">::</span>HeadStep<span class="op">(</span><span class="dt">double</span> StepSize<span class="op">,</span> <span class="dt">double</span> output<span class="op">)</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="moduleswormbody.cpp-1-item"><a href="../modules/WormBody.cpp"><code>../modules/WormBody.cpp</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
BUG (line 38)</p><details>
<div class="sourceCode" id="cb16" data-startFrom="38"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 37;"><span id="cb16-38"><a href="#cb16-38"></a> <span class="pp">#ifdef DEBUG</span></span>
<span id="cb16-39"><a href="#cb16-39"></a>     <span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb16-40"><a href="#cb16-40"></a> <span class="pp">#endif</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesvectormatrix.h-3-items"><a href="../modules/VectorMatrix.h"><code>../modules/VectorMatrix.h</code></a> – 3 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
BUG 0 (line 16)</p><details>
<div class="sourceCode" id="cb17" data-startFrom="16"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 15;"><span id="cb17-16"><a href="#cb17-16"></a> <span class="pp">#define DEBUG 0</span></span>
<span id="cb17-17"><a href="#cb17-17"></a> <span class="co">// *******</span></span>
<span id="cb17-18"><a href="#cb17-18"></a> <span class="co">// TVector</span></span>
<span id="cb17-19"><a href="#cb17-19"></a> <span class="co">// *******</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG (line 290)</p><details>
<div class="sourceCode" id="cb18" data-startFrom="290"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 289;"><span id="cb18-290"><a href="#cb18-290"></a> <span class="pp">#if !DEBUG</span></span>
<span id="cb18-291"><a href="#cb18-291"></a>         <span class="cf">return</span> Matrix<span class="op">[</span>index<span class="op">];</span></span>
<span id="cb18-292"><a href="#cb18-292"></a> <span class="pp">#else</span></span>
<span id="cb18-293"><a href="#cb18-293"></a>         <span class="cf">if</span> <span class="op">(</span>index <span class="op">&lt;</span> lb1 <span class="op">||</span> index <span class="op">&gt;</span> ub1<span class="op">)</span></span>
<span id="cb18-294"><a href="#cb18-294"></a>         <span class="op">{</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
BUG (line 51)</p><details>
<div class="sourceCode" id="cb19" data-startFrom="51"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 50;"><span id="cb19-51"><a href="#cb19-51"></a> <span class="pp">#if !DEBUG</span></span>
<span id="cb19-52"><a href="#cb19-52"></a>         <span class="cf">return</span> Vector<span class="op">[</span>index<span class="op">];</span></span>
<span id="cb19-53"><a href="#cb19-53"></a> <span class="pp">#else</span></span>
<span id="cb19-54"><a href="#cb19-54"></a>         <span class="cf">return</span> <span class="op">(*</span>this<span class="op">)(</span>index<span class="op">);</span></span>
<span id="cb19-55"><a href="#cb19-55"></a> <span class="pp">#endif</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutildiffusioncollide_standalone.h-1-item"><a href="../pyutil/diffusion/Collide_standalone.h"><code>../pyutil/diffusion/Collide_standalone.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
BUG(” &gt;&gt; elements in CollObjs vec: %ld“, CollObjs.size()) (line 224)</p><details>
<div class="sourceCode" id="cb20" data-startFrom="224"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 223;"><span id="cb20-224"><a href="#cb20-224"></a> PRINTF_DEBUG<span class="op">(</span><span class="st">&quot;    &gt;&gt; elements in CollObjs vec: %ld</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> CollObjs<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb20-225"><a href="#cb20-225"></a> <span class="cf">for</span> <span class="op">(</span>CollisionObject obj <span class="op">:</span> CollObjs<span class="op">)</span></span>
<span id="cb20-226"><a href="#cb20-226"></a> <span class="op">{</span></span>
<span id="cb20-227"><a href="#cb20-227"></a>     <span class="cf">if</span> <span class="op">(</span>obj<span class="op">.</span>coll_type <span class="op">==</span> Box_Ax<span class="op">)</span></span></code></pre></div>
</details></li>
</ul>
<h1 id="review-15-items"><strong>REVIEW</strong> – 15 items</h1>
<h2 id="modulesnervoussystem.cpp-2-items"><a href="../modules/NervousSystem.cpp"><code>../modules/NervousSystem.cpp</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: why… why is this 1-indexed (line 128)</p><details>
<div class="sourceCode" id="cb21" data-startFrom="128"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 127;"><span id="cb21-128"><a href="#cb21-128"></a> <span class="co">// REVIEW: why... why is this 1-indexed</span></span>
<span id="cb21-129"><a href="#cb21-129"></a> states<span class="op">.</span>SetBounds<span class="op">(</span><span class="dv">1</span><span class="op">,</span>size<span class="op">);</span></span>
<span id="cb21-130"><a href="#cb21-130"></a> states<span class="op">.</span>FillContents<span class="op">(</span><span class="fl">0.0</span><span class="op">);</span></span>
<span id="cb21-131"><a href="#cb21-131"></a> paststates<span class="op">.</span>SetBounds<span class="op">(</span><span class="dv">1</span><span class="op">,</span>size<span class="op">);</span>  </span>
<span id="cb21-132"><a href="#cb21-132"></a> paststates<span class="op">.</span>FillContents<span class="op">(</span><span class="fl">0.0</span><span class="op">);</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
REVIEW: connection count calculation is bugged :/ (line 59)</p><details>
<div class="sourceCode" id="cb22" data-startFrom="59"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 58;"><span id="cb22-59"><a href="#cb22-59"></a> <span class="co">// REVIEW: connection count calculation is bugged :/</span></span>
<span id="cb22-60"><a href="#cb22-60"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: instead of adding the maxs together, merge the lists and take the max once</span></span>
<span id="cb22-61"><a href="#cb22-61"></a> <span class="dt">int</span> max_CHEM <span class="op">=</span> compute_maxconn_bidir<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections&quot;</span><span class="op">],</span> CONNTYPE_CHEM<span class="op">)</span> </span>
<span id="cb22-62"><a href="#cb22-62"></a>     <span class="op">+</span> compute_maxconn_bidir_sum<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections_fwd&quot;</span><span class="op">],</span> CONNTYPE_CHEM<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb22-63"><a href="#cb22-63"></a> <span class="dt">int</span> max_ELE <span class="op">=</span> compute_maxconn_bidir_sum<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections&quot;</span><span class="op">],</span> CONNTYPE_ELE<span class="op">)</span> </span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesworm.cpp-2-items"><a href="../modules/Worm.cpp"><code>../modules/Worm.cpp</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: not very clean (line 252)</p><details>
<div class="sourceCode" id="cb23" data-startFrom="252"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 251;"><span id="cb23-252"><a href="#cb23-252"></a> <span class="co">// REVIEW: not very clean </span></span>
<span id="cb23-253"><a href="#cb23-253"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; NMJ params</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb23-254"><a href="#cb23-254"></a> NMJ_DB <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;DB&quot;</span><span class="op">];</span></span>
<span id="cb23-255"><a href="#cb23-255"></a> NMJ_VBa <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;VBA&quot;</span><span class="op">];</span></span>
<span id="cb23-256"><a href="#cb23-256"></a> NMJ_VBp <span class="op">=</span> params<span class="op">[</span><span class="st">&quot;NMJ&quot;</span><span class="op">][</span><span class="st">&quot;VBP&quot;</span><span class="op">];</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
REVIEW: what is this doing? (line 267)</p><details>
<div class="sourceCode" id="cb24" data-startFrom="267"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 266;"><span id="cb24-267"><a href="#cb24-267"></a> <span class="co">// REVIEW: what is this doing?</span></span>
<span id="cb24-268"><a href="#cb24-268"></a> PRINT_DEBUG<span class="op">(</span><span class="st">&quot;  &gt; NMJ gain (?)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb24-269"><a href="#cb24-269"></a> NMJ_Gain_Map <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb24-270"><a href="#cb24-270"></a> NMJ_Gain<span class="op">.</span>SetBounds<span class="op">(</span><span class="dv">1</span><span class="op">,</span> N_muscles<span class="op">);</span></span>
<span id="cb24-271"><a href="#cb24-271"></a> <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&lt;=</span>N_muscles<span class="op">;</span> i<span class="op">++)</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="moduleswormbody.cpp-1-item-1"><a href="../modules/WormBody.cpp"><code>../modules/WormBody.cpp</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: this parameter can be tuned (line 57)</p><details>
<div class="sourceCode" id="cb25" data-startFrom="57"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 56;"><span id="cb25-57"><a href="#cb25-57"></a> <span class="co">// REVIEW: this parameter can be tuned</span></span>
<span id="cb25-58"><a href="#cb25-58"></a> <span class="dt">double</span> radius_check<span class="op">;</span></span>
<span id="cb25-59"><a href="#cb25-59"></a> <span class="co">// Initialize various vectors of per rod body constants</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulescollide.h-2-items"><a href="../modules/Collide.h"><code>../modules/Collide.h</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: unclear what this does (line 169)</p><details>
<div class="sourceCode" id="cb26" data-startFrom="169"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 168;"><span id="cb26-169"><a href="#cb26-169"></a> <span class="co">// REVIEW: unclear what this does</span></span>
<span id="cb26-170"><a href="#cb26-170"></a>   realtype P_x<span class="op">,</span>P_y<span class="op">,</span>Distance<span class="op">,</span>magF<span class="op">,</span>D_scale<span class="op">,</span>magF_P1<span class="op">,</span>magF_P2<span class="op">;</span></span>
<span id="cb26-171"><a href="#cb26-171"></a> <span class="co">// reset contact force</span></span>
<span id="cb26-172"><a href="#cb26-172"></a>   ContactForce <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
REVIEW: this would be cleaner if I used polymorphism properly lol (line 31)</p><details>
<div class="sourceCode" id="cb27" data-startFrom="31"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 30;"><span id="cb27-31"><a href="#cb27-31"></a> <span class="co">// REVIEW: this would be cleaner if I used polymorphism properly lol</span></span>
<span id="cb27-32"><a href="#cb27-32"></a> <span class="kw">struct</span> CollisionObject</span>
<span id="cb27-33"><a href="#cb27-33"></a> <span class="op">{</span></span>
<span id="cb27-34"><a href="#cb27-34"></a>     CollisionType coll_type<span class="op">;</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesnervoussystem.h-1-item"><a href="../modules/NervousSystem.h"><code>../modules/NervousSystem.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: for some reason these cause a “multiple definitions” error unless they are inlined (line 56)</p><details>
<div class="sourceCode" id="cb28" data-startFrom="56"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 55;"><span id="cb28-56"><a href="#cb28-56"></a> <span class="co">// REVIEW: for some reason these cause a &quot;multiple definitions&quot; error unless they are inlined</span></span>
<span id="cb28-57"><a href="#cb28-57"></a> <span class="kw">inline</span> <span class="dt">int</span> compute_size<span class="op">(</span>json <span class="op">&amp;</span> neurons<span class="op">)</span></span>
<span id="cb28-58"><a href="#cb28-58"></a> <span class="op">{</span></span>
<span id="cb28-59"><a href="#cb28-59"></a>     <span class="cf">return</span> std<span class="op">::</span>distance<span class="op">(</span>neurons<span class="op">.</span>begin<span class="op">(),</span> neurons<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb28-60"><a href="#cb28-60"></a> <span class="op">}</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutildiffusioncollide_standalone.h-1-item-1"><a href="../pyutil/diffusion/Collide_standalone.h"><code>../pyutil/diffusion/Collide_standalone.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: this would be cleaner if I used polymorphism properly lol (line 19)</p><details>
<div class="sourceCode" id="cb29" data-startFrom="19"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 18;"><span id="cb29-19"><a href="#cb29-19"></a> <span class="co">// REVIEW: this would be cleaner if I used polymorphism properly lol</span></span>
<span id="cb29-20"><a href="#cb29-20"></a> <span class="kw">struct</span> CollisionObject</span>
<span id="cb29-21"><a href="#cb29-21"></a> <span class="op">{</span></span>
<span id="cb29-22"><a href="#cb29-22"></a>     CollisionType coll_type<span class="op">;</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutileval_run.py-1-item"><a href="../pyutil/eval_run.py"><code>../pyutil/eval_run.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: very fragile (line 267)</p><details>
<div class="sourceCode" id="cb30" data-startFrom="267"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 266;"><span id="cb30-267"><a href="#cb30-267"></a> <span class="co"># REVIEW: very fragile</span></span>
<span id="cb30-268"><a href="#cb30-268"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: make less fragile</span></span>
<span id="cb30-269"><a href="#cb30-269"></a> <span class="co"># UGLY: very fragile</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilgenetic_utils.py-2-items"><a href="../pyutil/genetic_utils.py"><code>../pyutil/genetic_utils.py</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: I think this actually makes the mutations too small (line 658)</p><details>
<div class="sourceCode" id="cb31" data-startFrom="658"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 657;"><span id="cb31-658"><a href="#cb31-658"></a> <span class="co"># REVIEW: I think this actually makes the mutations too small</span></span>
<span id="cb31-659"><a href="#cb31-659"></a></span>
<span id="cb31-660"><a href="#cb31-660"></a> ranges : ModParamsRanges <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb31-661"><a href="#cb31-661"></a></span>
<span id="cb31-662"><a href="#cb31-662"></a> <span class="cf">if</span> ranges_override <span class="kw">is</span> <span class="va">None</span>:</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
REVIEW: this return (line 935)</p><details>
<div class="sourceCode" id="cb32" data-startFrom="935"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 934;"><span id="cb32-935"><a href="#cb32-935"></a> <span class="co"># REVIEW: this return</span></span>
<span id="cb32-936"><a href="#cb32-936"></a> <span class="co"># return pop[0]</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilparams.py-3-items"><a href="../pyutil/params.py"><code>../pyutil/params.py</code></a> – 3 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
REVIEW: this isnt full regex, but whatever (line 207)</p><details>
<div class="sourceCode" id="cb33" data-startFrom="207"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 206;"><span id="cb33-207"><a href="#cb33-207"></a> <span class="co"># REVIEW: this isnt full regex, but whatever</span></span>
<span id="cb33-208"><a href="#cb33-208"></a> <span class="cf">if</span> nrn.startswith(conn_key[<span class="st">&#39;to&#39;</span>].split(<span class="st">&#39;*&#39;</span>)[<span class="dv">0</span>]):</span>
<span id="cb33-209"><a href="#cb33-209"></a>     conn_key_temp[<span class="st">&#39;to&#39;</span>] <span class="op">=</span> nrn</span>
<span id="cb33-210"><a href="#cb33-210"></a>     cidx_temp <span class="op">=</span> find_conn_idx(</span>
<span id="cb33-211"><a href="#cb33-211"></a>         params_data[conn_key_temp[<span class="st">&#39;NS&#39;</span>]][<span class="st">&#39;connections&#39;</span>],</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
REVIEW: this isnt full regex, but whatever (line 224)</p><details>
<div class="sourceCode" id="cb34" data-startFrom="224"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 223;"><span id="cb34-224"><a href="#cb34-224"></a> <span class="co"># REVIEW: this isnt full regex, but whatever</span></span>
<span id="cb34-225"><a href="#cb34-225"></a> <span class="cf">if</span> nrn.startswith(conn_key[<span class="st">&#39;from&#39;</span>].split(<span class="st">&#39;*&#39;</span>)[<span class="dv">0</span>]):</span>
<span id="cb34-226"><a href="#cb34-226"></a>     conn_key_temp[<span class="st">&#39;from&#39;</span>] <span class="op">=</span> nrn</span>
<span id="cb34-227"><a href="#cb34-227"></a>     cidx_temp <span class="op">=</span> find_conn_idx(</span>
<span id="cb34-228"><a href="#cb34-228"></a>         params_data[conn_key_temp[<span class="st">&#39;NS&#39;</span>]][<span class="st">&#39;connections&#39;</span>],</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
REVIEW: why did i even refactor this when im making everything editable through params json anyway? (line 299)</p><details>
<div class="sourceCode" id="cb35" data-startFrom="299"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 298;"><span id="cb35-299"><a href="#cb35-299"></a> <span class="co"># REVIEW: why did i even refactor this when im making everything editable through params json anyway?</span></span>
<span id="cb35-300"><a href="#cb35-300"></a> <span class="cf">for</span> tup_key,val <span class="kw">in</span> params_mod.items():</span>
<span id="cb35-301"><a href="#cb35-301"></a>     <span class="co"># merge in the standard params</span></span>
<span id="cb35-302"><a href="#cb35-302"></a>     <span class="cf">if</span> tup_key.mod_type <span class="op">==</span> ModTypes.params.value:</span></code></pre></div>
</details></li>
</ul>
<h1 id="todo-30-items"><strong>TODO</strong> – 30 items</h1>
<h2 id="modulesnervoussystem.cpp-2-items-1"><a href="../modules/NervousSystem.cpp"><code>../modules/NervousSystem.cpp</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: when switching to 0-idx, remove the +1 here (line 393)</p><details>
<div class="sourceCode" id="cb36" data-startFrom="393"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 392;"><span id="cb36-393"><a href="#cb36-393"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: when switching to 0-idx, remove the +1 here</span></span>
<span id="cb36-394"><a href="#cb36-394"></a> <span class="dt">int</span> idx <span class="op">=</span> idx_shift <span class="op">+</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb36-395"><a href="#cb36-395"></a> <span class="co">// if the shift index is nonzero, dont add the names to the map</span></span>
<span id="cb36-396"><a href="#cb36-396"></a> PRINTF_DEBUG_NRNDET<span class="op">(</span><span class="st">&quot;        &gt;&gt;  creating neuron </span><span class="sc">%s</span><span class="st"> at idx </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> nrn<span class="op">.</span>key<span class="op">().</span>c_str<span class="op">(),</span> idx<span class="op">)</span></span>
<span id="cb36-397"><a href="#cb36-397"></a> <span class="cf">if</span> <span class="op">(</span>idx_shift <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: instead of adding the maxs together, merge the lists and take the max once (line 60)</p><details>
<div class="sourceCode" id="cb37" data-startFrom="60"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 59;"><span id="cb37-60"><a href="#cb37-60"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: instead of adding the maxs together, merge the lists and take the max once</span></span>
<span id="cb37-61"><a href="#cb37-61"></a> <span class="dt">int</span> max_CHEM <span class="op">=</span> compute_maxconn_bidir<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections&quot;</span><span class="op">],</span> CONNTYPE_CHEM<span class="op">)</span> </span>
<span id="cb37-62"><a href="#cb37-62"></a>     <span class="op">+</span> compute_maxconn_bidir_sum<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections_fwd&quot;</span><span class="op">],</span> CONNTYPE_CHEM<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb37-63"><a href="#cb37-63"></a> <span class="dt">int</span> max_ELE <span class="op">=</span> compute_maxconn_bidir_sum<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections&quot;</span><span class="op">],</span> CONNTYPE_ELE<span class="op">)</span> </span>
<span id="cb37-64"><a href="#cb37-64"></a>     <span class="op">+</span> compute_maxconn_bidir_sum<span class="op">(</span>ns_data<span class="op">[</span><span class="st">&quot;connections_fwd&quot;</span><span class="op">],</span> CONNTYPE_ELE<span class="op">);</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesworm.cpp-1-item"><a href="../modules/Worm.cpp"><code>../modules/Worm.cpp</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: dynamically read from hash map (line 354)</p><details>
<div class="sourceCode" id="cb38" data-startFrom="354"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 353;"><span id="cb38-354"><a href="#cb38-354"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: dynamically read from hash map</span></span>
<span id="cb38-355"><a href="#cb38-355"></a> <span class="co">// Set input to Muscles</span></span>
<span id="cb38-356"><a href="#cb38-356"></a> <span class="co">//  Input from the head circuit</span></span>
<span id="cb38-357"><a href="#cb38-357"></a> dorsalHeadInput <span class="op">=</span> NMJ_SMDD<span class="op">*</span>h<span class="op">.</span>NeuronOutput<span class="op">(</span>SMDD<span class="op">)</span> <span class="op">+</span> NMJ_RMDV<span class="op">*</span>h<span class="op">.</span>NeuronOutput<span class="op">(</span>RMDD<span class="op">);</span></span>
<span id="cb38-358"><a href="#cb38-358"></a> ventralHeadInput <span class="op">=</span> NMJ_SMDV<span class="op">*</span>h<span class="op">.</span>NeuronOutput<span class="op">(</span>SMDV<span class="op">)</span> <span class="op">+</span> NMJ_RMDD<span class="op">*</span>h<span class="op">.</span>NeuronOutput<span class="op">(</span>RMDV<span class="op">);</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulescollide.h-3-items"><a href="../modules/Collide.h"><code>../modules/Collide.h</code></a> – 3 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: do_collide_friction function (line 136)</p><details>
<div class="sourceCode" id="cb39" data-startFrom="136"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 135;"><span id="cb39-136"><a href="#cb39-136"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: do_collide_friction function</span></span>
<span id="cb39-137"><a href="#cb39-137"></a> <span class="co">// loop over all the objects and all the points</span></span>
<span id="cb39-138"><a href="#cb39-138"></a> <span class="co">// and check for collisions</span></span>
<span id="cb39-139"><a href="#cb39-139"></a> <span class="kw">inline</span> std<span class="op">::</span>vector<span class="op">&lt;</span>VecXY<span class="op">&gt;</span> do_collide_vec<span class="op">(</span>std<span class="op">::</span>vector<span class="op">&lt;</span>VecXY<span class="op">&gt;</span> <span class="op">&amp;</span> pos_vec<span class="op">,</span> std<span class="op">::</span>vector<span class="op">&lt;</span>CollisionObject<span class="op">&gt;</span> <span class="op">&amp;</span> objs_vec<span class="op">);</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: instead of checking distance, check inside collision box (see existing python code) (line 199)</p><details>
<div class="sourceCode" id="cb40" data-startFrom="199"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 198;"><span id="cb40-199"><a href="#cb40-199"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: instead of checking distance, check inside collision box (see existing python code)</span></span>
<span id="cb40-200"><a href="#cb40-200"></a> <span class="cf">if</span><span class="op">(</span>Distance <span class="op">&lt;</span> Objects<span class="op">[</span>k<span class="op">][</span><span class="dv">2</span><span class="op">]){</span></span>
<span id="cb40-201"><a href="#cb40-201"></a>     magF <span class="op">=</span> <span class="op">(</span></span>
<span id="cb40-202"><a href="#cb40-202"></a>         k_Object <span class="op">*</span> <span class="op">(</span>Objects<span class="op">[</span>k<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">-</span> Distance<span class="op">)</span> </span>
<span id="cb40-203"><a href="#cb40-203"></a>         <span class="op">+</span> D_scale<span class="op">*</span>k_Object <span class="op">*</span> <span class="op">(</span>pow<span class="op">((</span>Objects<span class="op">[</span>k<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">-</span> Distance<span class="op">)</span> <span class="op">/</span> D_scale<span class="op">,</span><span class="dv">2</span><span class="op">))</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: this needs to call the data structure used in the Izquierdo code (line 225)</p><details>
<div class="sourceCode" id="cb41" data-startFrom="225"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 224;"><span id="cb41-225"><a href="#cb41-225"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: this needs to call the data structure used in the Izquierdo code</span></span>
<span id="cb41-226"><a href="#cb41-226"></a>   <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> NSEG<span class="op">;</span> <span class="op">++</span>i<span class="op">){</span></span>
<span id="cb41-227"><a href="#cb41-227"></a>     <span class="dt">int</span> i_minus_1 <span class="op">=</span> i<span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb41-228"><a href="#cb41-228"></a>     F_term<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> F_H<span class="op">[</span>i_minus_1<span class="op">][</span><span class="dv">0</span><span class="op">]*</span>Dir<span class="op">[</span>i_minus_1<span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">-</span> F_H<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]*</span>Dir<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> F_D<span class="op">[</span>i_minus_1<span class="op">][</span><span class="dv">1</span><span class="op">]*</span>Dir_D<span class="op">[</span>i_minus_1<span class="op">][</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">-</span> F_D<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]*</span>Dir_D<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> F_object<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">];</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesnervoussystem.h-1-item-1"><a href="../modules/NervousSystem.h"><code>../modules/NervousSystem.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: deprecate (line 161)</p><details>
<div class="sourceCode" id="cb42" data-startFrom="161"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 160;"><span id="cb42-161"><a href="#cb42-161"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: deprecate</span></span>
<span id="cb42-162"><a href="#cb42-162"></a> std<span class="op">::</span>unordered_map<span class="op">&lt;</span>string<span class="op">,</span><span class="dt">int</span><span class="op">&gt;</span> namesMap<span class="op">;</span></span>
<span id="cb42-163"><a href="#cb42-163"></a> std<span class="op">::</span>vector<span class="op">&lt;</span>string<span class="op">&gt;</span> namesMapInv<span class="op">;</span></span>
<span id="cb42-164"><a href="#cb42-164"></a></span>
<span id="cb42-165"><a href="#cb42-165"></a> <span class="dt">void</span> AddSynapse_JSON<span class="op">(</span>json <span class="op">&amp;</span> syn<span class="op">,</span> <span class="dt">int</span> idx_shift_A <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">int</span> idx_shift_B <span class="op">=</span> <span class="dv">0</span><span class="op">);</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulesstretchreceptor.h-1-item"><a href="../modules/StretchReceptor.h"><code>../modules/StretchReceptor.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: make this more accurate – corner distance, or full diffusion sim (line 95)</p><details>
<div class="sourceCode" id="cb43" data-startFrom="95"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 94;"><span id="cb43-95"><a href="#cb43-95"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: make this more accurate -- corner distance, or full diffusion sim</span></span>
<span id="cb43-96"><a href="#cb43-96"></a> <span class="co">// set the concentration to zero if it is more than some max distance away</span></span>
<span id="cb43-97"><a href="#cb43-97"></a> <span class="co">// OPTIMIZE: make branchless by multiplying gradient by bool</span></span>
<span id="cb43-98"><a href="#cb43-98"></a> <span class="dt">double</span> food_dist_sqrd <span class="op">=</span> dist_sqrd<span class="op">(</span>headpos<span class="op">,</span> foodpos<span class="op">);</span></span>
<span id="cb43-99"><a href="#cb43-99"></a> <span class="cf">if</span> <span class="op">(</span>pow<span class="op">(</span>dist_sqrd<span class="op">(</span>headpos<span class="op">,</span> foodpos<span class="op">),</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">&gt;</span> max_distance<span class="op">)</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulespackagescxxopts.hpp-2-items"><a href="../modules/packages/cxxopts.hpp"><code>../modules/packages/cxxopts.hpp</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: maybe default options should count towards the number of arguments (line 1163)</p><details>
<div class="sourceCode" id="cb44" data-startFrom="1163"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 1162;"><span id="cb44-1163"><a href="#cb44-1163"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: maybe default options should count towards the number of arguments</span></span>
<span id="cb44-1164"><a href="#cb44-1164"></a> CXXOPTS_NODISCARD</span>
<span id="cb44-1165"><a href="#cb44-1165"></a> <span class="dt">bool</span></span>
<span id="cb44-1166"><a href="#cb44-1166"></a> has_default<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb44-1167"><a href="#cb44-1167"></a> <span class="op">{</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: remove the duplicate code here (line 1852)</p><details>
<div class="sourceCode" id="cb45" data-startFrom="1852"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 1851;"><span id="cb45-1852"><a href="#cb45-1852"></a>   <span class="co">// </span><span class="al">TODO</span><span class="co">: remove the duplicate code here</span></span>
<span id="cb45-1853"><a href="#cb45-1853"></a>   <span class="kw">auto</span><span class="op">&amp;</span> store <span class="op">=</span> <span class="va">m_parsed</span><span class="op">[</span>details<span class="op">-&gt;</span>hash<span class="op">()];</span></span>
<span id="cb45-1854"><a href="#cb45-1854"></a>   store<span class="op">.</span>parse_default<span class="op">(</span>details<span class="op">);</span></span>
<span id="cb45-1855"><a href="#cb45-1855"></a> <span class="op">}</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutildiffusioncollide_standalone.h-1-item-2"><a href="../pyutil/diffusion/Collide_standalone.h"><code>../pyutil/diffusion/Collide_standalone.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: do_collide_friction function (line 323)</p><details>
<div class="sourceCode" id="cb46" data-startFrom="323"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 322;"><span id="cb46-323"><a href="#cb46-323"></a> <span class="co">// </span><span class="al">TODO</span><span class="co">: do_collide_friction function</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilcollision_object.py-1-item"><a href="../pyutil/collision_object.py"><code>../pyutil/collision_object.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO (minor): type hint to <code>CollisionType</code> doesn’t have expected behavior, this is just because python enum type hints are weird (line 48)</p><details>
<div class="sourceCode" id="cb47" data-startFrom="48"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 47;"><span id="cb47-48"><a href="#cb47-48"></a> <span class="co"># </span><span class="al">TODO</span><span class="co"> (minor): type hint to `CollisionType` doesn&#39;t have expected behavior, this is just because python enum type hints are weird</span></span>
<span id="cb47-49"><a href="#cb47-49"></a> <span class="kw">class</span> CollisionObject(<span class="bu">object</span>):</span>
<span id="cb47-50"><a href="#cb47-50"></a></span>
<span id="cb47-51"><a href="#cb47-51"></a>     ATTRIBUTES : Dict[CollisionType,List[<span class="bu">str</span>]] <span class="op">=</span> {</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutileval_run.py-7-items"><a href="../pyutil/eval_run.py"><code>../pyutil/eval_run.py</code></a> – 7 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: ret_nan is not actually doing the correct thing here, although its probably unimportant. current implementation does not allow for just one of several processes failing (line 114)</p><details>
<div class="sourceCode" id="cb48" data-startFrom="114"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 113;"><span id="cb48-114"><a href="#cb48-114"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: ret_nan is not actually doing the correct thing here, although its probably unimportant. current implementation does not allow for just one of several processes failing</span></span>
<span id="cb48-115"><a href="#cb48-115"></a> extracted : Dict[Path,<span class="bu">float</span>] <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb48-116"><a href="#cb48-116"></a> <span class="cf">for</span> p <span class="kw">in</span> os.listdir(datadir):</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: implement extracting more data, for parameter sweeps (line 258)</p><details>
<div class="sourceCode" id="cb49" data-startFrom="258"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 257;"><span id="cb49-258"><a href="#cb49-258"></a>     <span class="co"># </span><span class="al">TODO</span><span class="co">: implement extracting more data, for parameter sweeps</span></span>
<span id="cb49-259"><a href="#cb49-259"></a>     <span class="cf">raise</span> <span class="pp">NotImplementedError</span>(<span class="st">&#39;please implement me :(&#39;</span>)</span>
<span id="cb49-260"><a href="#cb49-260"></a> <span class="kw">def</span> calcmean_symmetric(data : Dict[<span class="bu">str</span>,<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: make less fragile (line 268)</p><details>
<div class="sourceCode" id="cb50" data-startFrom="268"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 267;"><span id="cb50-268"><a href="#cb50-268"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: make less fragile</span></span>
<span id="cb50-269"><a href="#cb50-269"></a> <span class="co"># UGLY: very fragile</span></span>
<span id="cb50-270"><a href="#cb50-270"></a> <span class="co"># get the angles and match with pairs</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: use params json instead? (line 278)</p><details>
<div class="sourceCode" id="cb51" data-startFrom="278"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 277;"><span id="cb51-278"><a href="#cb51-278"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: use params json instead?</span></span>
<span id="cb51-279"><a href="#cb51-279"></a> k_dict : Dict[<span class="bu">str</span>,<span class="bu">str</span>] <span class="op">=</span> dict_from_dirname(k, func_cast <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb51-280"><a href="#cb51-280"></a> <span class="co"># take absolute value</span></span>
<span id="cb51-281"><a href="#cb51-281"></a> angle : <span class="bu">str</span> <span class="op">=</span> k_dict[<span class="st">&#39;angle&#39;</span>].strip(<span class="st">&#39;- &#39;</span>)</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: assert 2 elements in each list (line 286)</p><details>
<div class="sourceCode" id="cb52" data-startFrom="286"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 285;"><span id="cb52-286"><a href="#cb52-286"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: assert 2 elements in each list</span></span>
<span id="cb52-287"><a href="#cb52-287"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: assert all angles present</span></span>
<span id="cb52-288"><a href="#cb52-288"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: handle angle keys better?</span></span>
<span id="cb52-289"><a href="#cb52-289"></a> <span class="co"># min of each pair, then average</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: assert all angles present (line 287)</p><details>
<div class="sourceCode" id="cb53" data-startFrom="287"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 286;"><span id="cb53-287"><a href="#cb53-287"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: assert all angles present</span></span>
<span id="cb53-288"><a href="#cb53-288"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: handle angle keys better?</span></span>
<span id="cb53-289"><a href="#cb53-289"></a> <span class="co"># min of each pair, then average</span></span>
<span id="cb53-290"><a href="#cb53-290"></a> per_angle_min : Dict[<span class="bu">str</span>,<span class="bu">float</span>] <span class="op">=</span> {</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: handle angle keys better? (line 288)</p><details>
<div class="sourceCode" id="cb54" data-startFrom="288"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 287;"><span id="cb54-288"><a href="#cb54-288"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: handle angle keys better?</span></span>
<span id="cb54-289"><a href="#cb54-289"></a> <span class="co"># min of each pair, then average</span></span>
<span id="cb54-290"><a href="#cb54-290"></a> per_angle_min : Dict[<span class="bu">str</span>,<span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb54-291"><a href="#cb54-291"></a>     k : <span class="bu">min</span>(lst_v)</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilgenetic_utils.py-8-items"><a href="../pyutil/genetic_utils.py"><code>../pyutil/genetic_utils.py</code></a> – 8 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: review this function type (line 177)</p><details>
<div class="sourceCode" id="cb55" data-startFrom="177"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 176;"><span id="cb55-177"><a href="#cb55-177"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: review this function type</span></span>
<span id="cb55-178"><a href="#cb55-178"></a> GenoCombineFunc <span class="op">=</span> Callable</span>
<span id="cb55-179"><a href="#cb55-179"></a> <span class="co"># GenoCombineFunc = Callable[</span></span>
<span id="cb55-180"><a href="#cb55-180"></a> <span class="co">#     [ModParamsDict, ModParamsDict],</span></span>
<span id="cb55-181"><a href="#cb55-181"></a> <span class="co">#     ModParamsDict,</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: for some reason, <code>popsize_old</code> sometimes is less than or equal to zero. the max() is just a hack, since i dont know what causes the issue in the first place (line 291)</p><details>
<div class="sourceCode" id="cb56" data-startFrom="291"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 290;"><span id="cb56-291"><a href="#cb56-291"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: for some reason, `popsize_old` sometimes is less than or equal to zero. the max() is just a hack, since i dont know what causes the issue in the first place</span></span>
<span id="cb56-292"><a href="#cb56-292"></a> <span class="co"># random_selection : NDArray = np.random.randint(</span></span>
<span id="cb56-293"><a href="#cb56-293"></a> <span class="co">#     low = 0, </span></span>
<span id="cb56-294"><a href="#cb56-294"></a> <span class="co">#     high = max(1,popsize_old), </span></span>
<span id="cb56-295"><a href="#cb56-295"></a> <span class="co">#     size = (popsize_new, 2),</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: not the real median here, oops (line 523)</p><details>
<div class="sourceCode" id="cb57" data-startFrom="523"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 522;"><span id="cb57-523"><a href="#cb57-523"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: not the real median here, oops</span></span>
<span id="cb57-524"><a href="#cb57-524"></a> <span class="cf">if</span> lst_fit:</span>
<span id="cb57-525"><a href="#cb57-525"></a>     <span class="cf">return</span> {</span>
<span id="cb57-526"><a href="#cb57-526"></a>         <span class="st">&#39;max&#39;</span> : lst_fit[<span class="dv">0</span>],</span>
<span id="cb57-527"><a href="#cb57-527"></a>         <span class="st">&#39;median&#39;</span> : lst_fit[<span class="bu">len</span>(lst_fit) <span class="op">//</span> <span class="dv">2</span>],</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: fix typing here (line 559)</p><details>
<div class="sourceCode" id="cb58" data-startFrom="559"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 558;"><span id="cb58-559"><a href="#cb58-559"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: fix typing here</span></span>
<span id="cb58-560"><a href="#cb58-560"></a> <span class="cf">assert</span> <span class="kw">not</span> <span class="bu">any</span>(</span>
<span id="cb58-561"><a href="#cb58-561"></a>     f <span class="kw">is</span> <span class="va">None</span></span>
<span id="cb58-562"><a href="#cb58-562"></a>     <span class="cf">for</span> _,f <span class="kw">in</span> pop</span>
<span id="cb58-563"><a href="#cb58-563"></a> ), <span class="st">&quot;`None` fitness found when trying to run `generation_selection`&quot;</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: pop/push if the element count is not quite right? (line 587)</p><details>
<div class="sourceCode" id="cb59" data-startFrom="587"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 586;"><span id="cb59-587"><a href="#cb59-587"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: pop/push if the element count is not quite right?</span></span>
<span id="cb59-588"><a href="#cb59-588"></a> <span class="cf">return</span> newpop</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: document this (line 61)</p><details>
<div class="sourceCode" id="cb60" data-startFrom="61"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 60;"><span id="cb60-61"><a href="#cb60-61"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: document this</span></span>
<span id="cb60-62"><a href="#cb60-62"></a></span>
<span id="cb60-63"><a href="#cb60-63"></a> <span class="co"># make dir</span></span>
<span id="cb60-64"><a href="#cb60-64"></a> <span class="cf">if</span> out_name <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb60-65"><a href="#cb60-65"></a>     outpath : Path <span class="op">=</span> joinPath(rootdir, dict_hash(params_mod))</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: check that params jsons match. this also means that strip-only keys dont mean anything at the moment (line 768)</p><details>
<div class="sourceCode" id="cb61" data-startFrom="768"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 767;"><span id="cb61-768"><a href="#cb61-768"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: check that params jsons match. this also means that strip-only keys dont mean anything at the moment</span></span>
<span id="cb61-769"><a href="#cb61-769"></a> <span class="cf">if</span> params_ref <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb61-770"><a href="#cb61-770"></a>     <span class="cf">raise</span> <span class="pp">NotImplementedError</span>(<span class="st">&#39;checking that params match is not yet implemented&#39;</span>)</span>
<span id="cb61-771"><a href="#cb61-771"></a> <span class="co"># for p in lst_params_stripped:</span></span>
<span id="cb61-772"><a href="#cb61-772"></a> <span class="co">#     for k,v in p.items():</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: <code>pop_sizes</code> should be an input parameter (line 882)</p><details>
<div class="sourceCode" id="cb62" data-startFrom="882"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 881;"><span id="cb62-882"><a href="#cb62-882"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: `pop_sizes` should be an input parameter</span></span>
<span id="cb62-883"><a href="#cb62-883"></a> pop_sizes : List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> compute_gen_sizes(</span>
<span id="cb62-884"><a href="#cb62-884"></a>     first_gen_size <span class="op">=</span> first_gen_size,</span>
<span id="cb62-885"><a href="#cb62-885"></a>     gen_count <span class="op">=</span> gen_count,</span>
<span id="cb62-886"><a href="#cb62-886"></a>     factor_cull <span class="op">=</span> factor_cull,</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilread_runs.py-2-items"><a href="../pyutil/read_runs.py"><code>../pyutil/read_runs.py</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: load eval runs params (line 349)</p><details>
<div class="sourceCode" id="cb63" data-startFrom="349"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 348;"><span id="cb63-349"><a href="#cb63-349"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: load eval runs params</span></span>
<span id="cb63-350"><a href="#cb63-350"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: store intersection of params, collobjs</span></span>
<span id="cb63-351"><a href="#cb63-351"></a> output[<span class="st">&#39;rootdir&#39;</span>] <span class="op">=</span> unixPath(rootdir)</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
TODO: store intersection of params, collobjs (line 351)</p><details>
<div class="sourceCode" id="cb64" data-startFrom="351"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 350;"><span id="cb64-351"><a href="#cb64-351"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: store intersection of params, collobjs</span></span>
<span id="cb64-352"><a href="#cb64-352"></a> output[<span class="st">&#39;rootdir&#39;</span>] <span class="op">=</span> unixPath(rootdir)</span>
<span id="cb64-353"><a href="#cb64-353"></a> <span class="cf">return</span> output</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilplotpos.py-1-item"><a href="../pyutil/plot/pos.py"><code>../pyutil/plot/pos.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
TODO: make this actually reference matplotlib.Axes (line 55)</p><details>
<div class="sourceCode" id="cb65" data-startFrom="55"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 54;"><span id="cb65-55"><a href="#cb65-55"></a> <span class="co"># </span><span class="al">TODO</span><span class="co">: make this actually reference matplotlib.Axes</span></span>
<span id="cb65-56"><a href="#cb65-56"></a> Axes <span class="op">=</span> Any</span>
<span id="cb65-57"><a href="#cb65-57"></a> OptInt <span class="op">=</span> Optional[<span class="bu">int</span>]</span></code></pre></div>
</details></li>
</ul>
<h1 id="note-9-items"><strong>NOTE</strong> – 9 items</h1>
<h2 id="moduleswormbody.cpp-2-items"><a href="../modules/WormBody.cpp"><code>../modules/WormBody.cpp</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
NOTE 2: There is a discrepency between the BBC code and paper as to whether or not the factor of 2 here (line 13)</p><details>
<div class="sourceCode" id="cb66" data-startFrom="13"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 12;"><span id="cb66-13"><a href="#cb66-13"></a> <span class="co">//   </span><span class="al">NOTE</span><span class="co"> 2: There is a discrepency between the BBC code and paper as to whether or not the factor of 2 here</span></span>
<span id="cb66-14"><a href="#cb66-14"></a> <span class="co">//   should be raised to the fourth power (16). I have followed the BBC code in raising it to the fourth power</span></span>
<span id="cb66-15"><a href="#cb66-15"></a> <span class="co">//   (Boyle, personal communication, June 30, 2014).</span></span>
<span id="cb66-16"><a href="#cb66-16"></a> <span class="co">//</span></span>
<span id="cb66-17"><a href="#cb66-17"></a> <span class="co">//   </span><span class="al">NOTE</span><span class="co"> 3: There is a major discrepency between the BBC code on the one hand and the BBC paper and Boyle thesis</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
NOTE 3: There is a major discrepency between the BBC code on the one hand and the BBC paper and Boyle thesis (line 17)</p><details>
<div class="sourceCode" id="cb67" data-startFrom="17"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 16;"><span id="cb67-17"><a href="#cb67-17"></a> <span class="co">//   </span><span class="al">NOTE</span><span class="co"> 3: There is a major discrepency between the BBC code on the one hand and the BBC paper and Boyle thesis</span></span>
<span id="cb67-18"><a href="#cb67-18"></a> <span class="co">//   on the other as to the formula for dphi/dt. The BBC code uses (f_odd_par/C_par)/(M_PI*2.0*R[i]), but both documents</span></span>
<span id="cb67-19"><a href="#cb67-19"></a> <span class="co">//   use 2*f_odd_par/(R[i]*C_par). The argument for the latter formula makes perfect sense to me (see Boyle Thesis,</span></span>
<span id="cb67-20"><a href="#cb67-20"></a> <span class="co">//   p. 76, 128). However, I cannot understand where the first forumula comes from and Boyle was unable to shed any</span></span>
<span id="cb67-21"><a href="#cb67-21"></a> <span class="co">//   light on the matter (Boyle, personal communication, June 30, 2014). Which formula used does make a small but nontrivial</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="modulescollide.h-2-items-1"><a href="../modules/Collide.h"><code>../modules/Collide.h</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
NOTE: this printf statement is cursed. somehow <code>(fabs(y) &gt; EPSILON) ? "true" : "false"</code> evaluated to “sin” before causing a segfault. no clue what was going on. (line 87)</p><details>
<div class="sourceCode" id="cb68" data-startFrom="87"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 86;"><span id="cb68-87"><a href="#cb68-87"></a> <span class="co">// </span><span class="al">NOTE</span><span class="co">: this printf statement is cursed. somehow `(fabs(y) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;` evaluated to &quot;sin&quot; before causing a segfault. no clue what was going on.</span></span>
<span id="cb68-88"><a href="#cb68-88"></a> <span class="co">// printf(</span></span>
<span id="cb68-89"><a href="#cb68-89"></a> <span class="co">//     &quot;is_nonzero:\t%f,%f,%f\t%s,%s\n&quot;, </span></span>
<span id="cb68-90"><a href="#cb68-90"></a> <span class="co">//     fabs(x), fabs(y), EPSILON,</span></span>
<span id="cb68-91"><a href="#cb68-91"></a> <span class="co">//     (fabs(x) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;, </span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
NOTE: for some reason, abs() doesnt work and casts things to ints (line 94)</p><details>
<div class="sourceCode" id="cb69" data-startFrom="94"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 93;"><span id="cb69-94"><a href="#cb69-94"></a>     <span class="co">// </span><span class="al">NOTE</span><span class="co">: for some reason, abs() doesnt work and casts things to ints</span></span>
<span id="cb69-95"><a href="#cb69-95"></a>     <span class="co">// std::cout &lt;&lt; std::fixed;</span></span>
<span id="cb69-96"><a href="#cb69-96"></a>     <span class="co">// std::cout &lt;&lt; std::setprecision(5) &lt;&lt; &quot;is_nonzero:\t&quot; &lt;&lt; fabs(x) &lt;&lt; &quot;,&quot; &lt;&lt; fabs(y) &lt;&lt; &quot;,&quot;  &lt;&lt; EPSILON &lt;&lt; &quot;,&quot;  &lt;&lt; ((fabs(x) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;) &lt;&lt; &quot;,&quot;  &lt;&lt; ((fabs(y) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;) &lt;&lt; std::endl;</span></span>
<span id="cb69-97"><a href="#cb69-97"></a> <span class="op">}</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="moduleswormbody.h-1-item"><a href="../modules/WormBody.h"><code>../modules/WormBody.h</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
NOTE 1: I fixed an obvious C macro bug in the original BBC code. In that code, NBAR is defined to be “NSEG+1”, (line 13)</p><details>
<div class="sourceCode" id="cb70" data-startFrom="13"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 12;"><span id="cb70-13"><a href="#cb70-13"></a> <span class="co">//   </span><span class="al">NOTE</span><span class="co"> 1: I fixed an obvious C macro bug in the original BBC code. In that code, NBAR is defined to be &quot;NSEG+1&quot;,</span></span>
<span id="cb70-14"><a href="#cb70-14"></a> <span class="co">//   but then used in, e.g., &quot;2.0*NBAR&quot;, which expands into &quot;2.0*NSEG+1&quot; rather than &quot;2.0*(NSEG+1)&quot;.</span></span>
<span id="cb70-15"><a href="#cb70-15"></a> <span class="co">//</span></span>
<span id="cb70-16"><a href="#cb70-16"></a> <span class="co">// Created by Randall Beer on 7/8/14.</span></span>
<span id="cb70-17"><a href="#cb70-17"></a> <span class="co">// Copyright (c) 2014 Randall Beer. All rights reserved.</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutildiffusioncollide_standalone.h-2-items"><a href="../pyutil/diffusion/Collide_standalone.h"><code>../pyutil/diffusion/Collide_standalone.h</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
NOTE: this printf statement is cursed. somehow <code>(fabs(y) &gt; EPSILON) ? "true" : "false"</code> evaluated to “sin” before causing a segfault. no clue what was going on. (line 75)</p><details>
<div class="sourceCode" id="cb71" data-startFrom="75"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 74;"><span id="cb71-75"><a href="#cb71-75"></a> <span class="co">// </span><span class="al">NOTE</span><span class="co">: this printf statement is cursed. somehow `(fabs(y) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;` evaluated to &quot;sin&quot; before causing a segfault. no clue what was going on.</span></span>
<span id="cb71-76"><a href="#cb71-76"></a> <span class="co">// printf(</span></span>
<span id="cb71-77"><a href="#cb71-77"></a> <span class="co">//     &quot;is_nonzero:\t%f,%f,%f\t%s,%s\n&quot;, </span></span>
<span id="cb71-78"><a href="#cb71-78"></a> <span class="co">//     fabs(x), fabs(y), EPSILON,</span></span>
<span id="cb71-79"><a href="#cb71-79"></a> <span class="co">//     (fabs(x) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;, </span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
NOTE: for some reason, abs() doesnt work and casts things to ints (line 82)</p><details>
<div class="sourceCode" id="cb72" data-startFrom="82"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 81;"><span id="cb72-82"><a href="#cb72-82"></a>     <span class="co">// </span><span class="al">NOTE</span><span class="co">: for some reason, abs() doesnt work and casts things to ints</span></span>
<span id="cb72-83"><a href="#cb72-83"></a>     <span class="co">// std::cout &lt;&lt; std::fixed;</span></span>
<span id="cb72-84"><a href="#cb72-84"></a>     <span class="co">// std::cout &lt;&lt; std::setprecision(5) &lt;&lt; &quot;is_nonzero:\t&quot; &lt;&lt; fabs(x) &lt;&lt; &quot;,&quot; &lt;&lt; fabs(y) &lt;&lt; &quot;,&quot;  &lt;&lt; EPSILON &lt;&lt; &quot;,&quot;  &lt;&lt; ((fabs(x) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;) &lt;&lt; &quot;,&quot;  &lt;&lt; ((fabs(y) &gt; EPSILON) ? &quot;true&quot; : &quot;false&quot;) &lt;&lt; std::endl;</span></span>
<span id="cb72-85"><a href="#cb72-85"></a> <span class="op">}</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutiloldwormview.m-2-items"><a href="../pyutil/old/WormView.m"><code>../pyutil/old/WormView.m</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
NOTE: Create figure then check box to fill axes! (line 38)</p><details>
<div class="sourceCode" id="cb73" data-startFrom="38"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 37;"><span id="cb73-38"><a href="#cb73-38"></a> <span class="op">%</span>NOTE<span class="op">:</span> Create figure then check box to fill axes<span class="op">!</span></span>
<span id="cb73-39"><a href="#cb73-39"></a> figure<span class="op">(</span>&#39;Position&#39;<span class="op">,[</span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">824</span> <span class="dv">588</span><span class="op">])</span></span>
<span id="cb73-40"><a href="#cb73-40"></a> XYratio <span class="op">=</span> <span class="fl">1.3333</span><span class="op">;</span>   <span class="op">%</span>This is the ratio of Xrange<span class="op">/</span>Yrange required to give equal axes</span>
<span id="cb73-41"><a href="#cb73-41"></a> R <span class="op">=</span> D<span class="op">/</span><span class="fl">2.0</span><span class="op">*</span>abs<span class="op">(</span>sin<span class="op">(</span>acos<span class="op">(((</span><span class="dv">0</span><span class="op">:</span>Nbar<span class="op">-</span><span class="dv">1</span><span class="op">)-</span>NSEG<span class="op">./</span><span class="fl">2.0</span><span class="op">)./(</span>NSEG<span class="op">/</span><span class="fl">2.0</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">))));</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
NOTE: if not using objects, you must delete any objects.csv file generated (line 8)</p><details>
<div class="sourceCode" id="cb74" data-startFrom="8"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c" style="counter-reset: source-line 7;"><span id="cb74-8"><a href="#cb74-8"></a> <span class="op">%</span>NOTE<span class="op">:</span> <span class="cf">if</span> not using objects<span class="op">,</span> you must delete any objects<span class="op">.</span>csv file generated</span>
<span id="cb74-9"><a href="#cb74-9"></a> <span class="op">%</span>during previous runs<span class="op">.</span></span>
<span id="cb74-10"><a href="#cb74-10"></a> usingObjects <span class="op">=</span> exist<span class="op">(</span>&#39;objects<span class="op">.</span>csv<span class="ch">&#39;,&#39;</span>file&#39;<span class="op">);</span></span>
<span id="cb74-11"><a href="#cb74-11"></a> <span class="cf">if</span> usingObjects </span>
<span id="cb74-12"><a href="#cb74-12"></a>     Objects <span class="op">=</span> importdata<span class="op">(</span>&#39;objects<span class="op">.</span>csv&#39;<span class="op">);</span></span></code></pre></div>
</details></li>
</ul>
<h1 id="optimize-5-items"><strong>OPTIMIZE</strong> – 5 items</h1>
<h2 id="moduleswormbody.cpp-1-item-2"><a href="../modules/WormBody.cpp"><code>../modules/WormBody.cpp</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
OPTIMIZE: can do clever chunking by checking only a subset of points against each object (line 285)</p><details>
<div class="sourceCode" id="cb75" data-startFrom="285"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 284;"><span id="cb75-285"><a href="#cb75-285"></a> <span class="co">// OPTIMIZE: can do clever chunking by checking only a subset of points against each object</span></span>
<span id="cb75-286"><a href="#cb75-286"></a> <span class="co">// loop over all collision boxes</span></span>
<span id="cb75-287"><a href="#cb75-287"></a> <span class="cf">for</span> <span class="op">(</span> CollisionObject obj <span class="op">:</span> CollObjs <span class="op">)</span></span>
<span id="cb75-288"><a href="#cb75-288"></a> <span class="op">{</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilgenetic_utils.py-2-items-1"><a href="../pyutil/genetic_utils.py"><code>../pyutil/genetic_utils.py</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
OPTIMIZE: this uses two loops (because its just a view over the list) when it could be using just one (line 149)</p><details>
<div class="sourceCode" id="cb76" data-startFrom="149"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 148;"><span id="cb76-149"><a href="#cb76-149"></a> <span class="co"># OPTIMIZE: this uses two loops (because its just a view over the list) when it could be using just one</span></span>
<span id="cb76-150"><a href="#cb76-150"></a> output : ModParamsRanges <span class="op">=</span> {</span>
<span id="cb76-151"><a href="#cb76-151"></a>     key : RangeTuple(</span>
<span id="cb76-152"><a href="#cb76-152"></a>         <span class="bu">min</span>(p[key] <span class="cf">for</span> p <span class="kw">in</span> pop),</span>
<span id="cb76-153"><a href="#cb76-153"></a>         <span class="bu">max</span>(p[key] <span class="cf">for</span> p <span class="kw">in</span> pop),</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
OPTIMIZE: each process could be read as it finishes – this is not perfectly efficient (line 485)</p><details>
<div class="sourceCode" id="cb77" data-startFrom="485"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 484;"><span id="cb77-485"><a href="#cb77-485"></a> <span class="co"># OPTIMIZE: each process could be read as it finishes -- this is not perfectly efficient</span></span>
<span id="cb77-486"><a href="#cb77-486"></a> <span class="cf">for</span> p <span class="kw">in</span> lst_proc:</span>
<span id="cb77-487"><a href="#cb77-487"></a>     p.wait()</span>
<span id="cb77-488"><a href="#cb77-488"></a> new_fit : <span class="bu">float</span> <span class="op">=</span> func_extract_multi(</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilplotgene.py-1-item"><a href="../pyutil/plot/gene.py"><code>../pyutil/plot/gene.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
OPTIMIZE: only scrape the ones with gen &gt; min_gen (line 210)</p><details>
<div class="sourceCode" id="cb78" data-startFrom="210"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 209;"><span id="cb78-210"><a href="#cb78-210"></a> <span class="co"># OPTIMIZE: only scrape the ones with gen &gt; min_gen</span></span>
<span id="cb78-211"><a href="#cb78-211"></a> data : Dict[GeneRunID, <span class="bu">float</span>] <span class="op">=</span> scrape_extracted_cache(rootdir)</span>
<span id="cb78-212"><a href="#cb78-212"></a> <span class="co"># first make bins based on all data</span></span>
<span id="cb78-213"><a href="#cb78-213"></a> bins,bin_centers <span class="op">=</span> get_bins(data, n_bins)</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilplotpos.py-1-item-1"><a href="../pyutil/plot/pos.py"><code>../pyutil/plot/pos.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
OPTIMIZE: this bit can be vectorized (line 208)</p><details>
<div class="sourceCode" id="cb79" data-startFrom="208"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 207;"><span id="cb79-208"><a href="#cb79-208"></a> <span class="co"># OPTIMIZE: this bit can be vectorized</span></span>
<span id="cb79-209"><a href="#cb79-209"></a> <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(n_tstep):</span>
<span id="cb79-210"><a href="#cb79-210"></a>     dX : <span class="bu">float</span> <span class="op">=</span> worm_thickness <span class="op">*</span> np.cos(data[t][<span class="st">&#39;phi&#39;</span>])</span>
<span id="cb79-211"><a href="#cb79-211"></a>     dY : <span class="bu">float</span> <span class="op">=</span> worm_thickness <span class="op">*</span> np.sin(data[t][<span class="st">&#39;phi&#39;</span>])</span>
<span id="cb79-212"><a href="#cb79-212"></a>     data_Dorsal[t][<span class="st">&#39;x&#39;</span>] <span class="op">=</span> data[t][<span class="st">&#39;x&#39;</span>] <span class="op">+</span> dX</span></code></pre></div>
</details></li>
</ul>
<h1 id="hack-1-item"><strong>HACK</strong> – 1 item</h1>
<h2 id="pyutilcollision_object.py-1-item-1"><a href="../pyutil/collision_object.py"><code>../pyutil/collision_object.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
HACK: at some point, the C++ code was producing collision object tsv (line 198)</p><details>
<div class="sourceCode" id="cb80" data-startFrom="198"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 197;"><span id="cb80-198"><a href="#cb80-198"></a> <span class="co"># </span><span class="al">HACK</span><span class="co">: at some point, the C++ code was producing collision object tsv</span></span>
<span id="cb80-199"><a href="#cb80-199"></a> <span class="co">#     files with an extra tab put in, meaning there was an extra empty </span></span>
<span id="cb80-200"><a href="#cb80-200"></a> <span class="co">#     string in every line when we split by tabs. hence, this line exists</span></span>
<span id="cb80-201"><a href="#cb80-201"></a> <span class="co">#     to deal with those files. it&#39;s safe to remove if you are only </span></span>
<span id="cb80-202"><a href="#cb80-202"></a> <span class="co">#     dealing with freshly generated files</span></span></code></pre></div>
</details></li>
</ul>
<h1 id="ugly-6-items"><strong>UGLY</strong> – 6 items</h1>
<h2 id="pyutileval_run.py-1-item-1"><a href="../pyutil/eval_run.py"><code>../pyutil/eval_run.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
UGLY: very fragile (line 269)</p><details>
<div class="sourceCode" id="cb81" data-startFrom="269"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 268;"><span id="cb81-269"><a href="#cb81-269"></a> <span class="co"># UGLY: very fragile</span></span>
<span id="cb81-270"><a href="#cb81-270"></a> <span class="co"># get the angles and match with pairs</span></span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilgenetic_utils.py-2-items-2"><a href="../pyutil/genetic_utils.py"><code>../pyutil/genetic_utils.py</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
UGLY: be able to modify the default fitness here (line 636)</p><details>
<div class="sourceCode" id="cb82" data-startFrom="636"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 635;"><span id="cb82-636"><a href="#cb82-636"></a> <span class="co"># UGLY: be able to modify the default fitness here</span></span>
<span id="cb82-637"><a href="#cb82-637"></a> min_fitness : <span class="bu">float</span> <span class="op">=</span> <span class="bu">min</span>([</span>
<span id="cb82-638"><a href="#cb82-638"></a>     fit</span>
<span id="cb82-639"><a href="#cb82-639"></a>     <span class="cf">if</span> <span class="kw">not</span> isnan(fit)</span>
<span id="cb82-640"><a href="#cb82-640"></a>     <span class="cf">else</span> <span class="fl">0.0</span></span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
UGLY: this function should just call the continuation function after initialization (line 792)</p><details>
<div class="sourceCode" id="cb83" data-startFrom="792"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 791;"><span id="cb83-792"><a href="#cb83-792"></a> <span class="co"># UGLY: this function should just call the continuation function after initialization</span></span>
<span id="cb83-793"><a href="#cb83-793"></a> <span class="kw">def</span> run_genetic_algorithm(</span>
<span id="cb83-794"><a href="#cb83-794"></a>         <span class="co"># for setup</span></span>
<span id="cb83-795"><a href="#cb83-795"></a>         rootdir : Path <span class="op">=</span> <span class="st">&quot;data/geno_sweep/&quot;</span>,</span>
<span id="cb83-796"><a href="#cb83-796"></a>         dists : ModParamsDists <span class="op">=</span> DEFAULT_DISTS,</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilparams.py-2-items"><a href="../pyutil/params.py"><code>../pyutil/params.py</code></a> – 2 items</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
UGLY: this whole bit (line 142)</p><details>
<div class="sourceCode" id="cb84" data-startFrom="142"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 141;"><span id="cb84-142"><a href="#cb84-142"></a> <span class="co"># UGLY: this whole bit</span></span>
<span id="cb84-143"><a href="#cb84-143"></a> <span class="cf">if</span> k.mod_type <span class="op">==</span> ModTypes.conn.value:</span>
<span id="cb84-144"><a href="#cb84-144"></a>     _,str_from,str_to,_ <span class="op">=</span> k.path.split(<span class="st">&#39;,&#39;</span>)</span>
<span id="cb84-145"><a href="#cb84-145"></a>     k_write <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>str_from<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>str_to<span class="sc">}</span><span class="ss">&quot;</span>.replace(<span class="st">&#39;*&#39;</span>,<span class="st">&#39;x&#39;</span>)</span>
<span id="cb84-146"><a href="#cb84-146"></a> <span class="cf">elif</span> k.mod_type <span class="op">==</span> ModTypes.params.value:</span></code></pre></div>
</details></li>
<li><p><input type="checkbox" disabled="" />
UGLY: clean this bit up (line 201)</p><details>
<div class="sourceCode" id="cb85" data-startFrom="201"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 200;"><span id="cb85-201"><a href="#cb85-201"></a> <span class="co"># UGLY: clean this bit up</span></span>
<span id="cb85-202"><a href="#cb85-202"></a> <span class="cf">if</span> conn_key[<span class="st">&#39;to&#39;</span>].endswith(<span class="st">&#39;*&#39;</span>):</span>
<span id="cb85-203"><a href="#cb85-203"></a>     <span class="co"># if wildcard given, find every connection that matches</span></span>
<span id="cb85-204"><a href="#cb85-204"></a>     <span class="cf">for</span> nrn <span class="kw">in</span> params_data[conn_key[<span class="st">&#39;NS&#39;</span>]][<span class="st">&#39;neurons&#39;</span>]:</span></code></pre></div>
</details></li>
</ul>
<h2 id="pyutilplotgene.py-1-item-1"><a href="../pyutil/plot/gene.py"><code>../pyutil/plot/gene.py</code></a> – 1 item</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" />
UGLY: this bit (line 110)</p><details>
<div class="sourceCode" id="cb86" data-startFrom="110"><pre class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 109;"><span id="cb86-110"><a href="#cb86-110"></a> <span class="co"># UGLY: this bit</span></span>
<span id="cb86-111"><a href="#cb86-111"></a> cache_load : Callable[[],Dict[<span class="bu">str</span>,Any]] <span class="op">=</span> <span class="kw">lambda</span> : raise_(<span class="pp">NotImplementedError</span>(<span class="st">&#39;check `scrape_extracted_cache()`&#39;</span>))</span>
<span id="cb86-112"><a href="#cb86-112"></a> cache_save : Callable[[Dict[<span class="bu">str</span>,<span class="bu">float</span>]],<span class="va">None</span>] <span class="op">=</span> <span class="kw">lambda</span> x : raise_(<span class="pp">NotImplementedError</span>(<span class="st">&#39;check `scrape_extracted_cache()`&#39;</span>))</span>
<span id="cb86-113"><a href="#cb86-113"></a> <span class="cf">if</span> <span class="bu">format</span> <span class="op">==</span> <span class="st">&#39;msgpack&#39;</span>:</span>
<span id="cb86-114"><a href="#cb86-114"></a>     <span class="im">import</span> msgpack <span class="co"># type: ignore</span></span></code></pre></div>
</details></li>
</ul>
</body>
</html>
